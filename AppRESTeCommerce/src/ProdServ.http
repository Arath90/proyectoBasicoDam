# Archivo: ProdServ.http
# Descripción:
# Este archivo permite probar las operaciones GET de la API de productos y servicios.
# Se define la variable @api con la URL base de la API local.
# Cada bloque realiza una petición GET para obtener todos los productos/servicios o uno específico.
# Los resultados esperados se muestran como ejemplo debajo de cada petición.

//Commerce
@api = http://localhost:3000/api/v1/prod-serv
#@api = http://187.229.22.99:8010/api/v1/prod-serv
### GET
GET {{api}}
### GET ITEM por IdProdServPK (primaria) = 1
GET {{api}}/100
### GET ITEM por IdProdServOK = 100 (Alterna)
GET {{api}}/LAP001?keyType=OK
### GET ITEM por IdProdServBK = ENSA100 (Alterna)
GET {{api}}/PROD-2024-01?keyType=BK
### POST ITEM PRODUCTO Y/O SERVICIO 
POST {{api}} 
Content-Type: application/json 
//IMPORTANTE QUITAR ESTA LINEA PERO DEJA EL RENGLON VACIO PORQUE DEBES RESPETAR EL ESPACIO DEL HEADER DE LA API
// !nota 7.4

{  
    "IdProdServPK" : 100,  
    "IdProdServOK" : "100",  
    "IdProdServBK" : "ENSA100",  
    "IdProdServMaOK" : "1",  
    "IdProdServMaBK" : "1",  
    "DesProdServ" : "ENFRIADOR VERTICAL G326 2PTAS CO2",  
    "IdUMedidaOK" : "1",  
    "IdUMedidaBK" : "1",  
    "cat_prod_serv_estatus" : [ 
        { 
            "IdTipoGenEstatusOK" : "4",  
            "IdGenEstatusOK" : "23",  
            "TipoEstatus" : "VIGENTE",  
            "Actual" : "S",  
            "Observacion" : "Ninguna",  
            "detail_row" : { 
                "FechaReg" : "2022-01-05T10:20:33+07:00",  
                "UsuarioReg" : "FIBARRAC" 
            } 
        } 
    ],  
    "cat_prod_serv_paquetes" : [ 
        { 
            "IdProdServOK" : "1",  
            "IdProdServBK" : "1",  
            "DesProdServ" : "ENFRIADOR VERTICAL G326 2PTAS CO2",  
            "Cantidad" : 1.0,  
            "IdUMedidaOK" : "1",  
            "IdUMedidaBK" : "1",  
            "detail_row" : { 
                "FechaReg" : "2022-01-05T10:20:33+07:00",  
                "UsuarioReg" : "FIBARRAC",  
                "FechaUltMod" : "2022-01-05T10:20:33+07:00",  
                "UsuarioMod" : "FIBARRAC",  
                "Activo" : "S",  
                "Borrado" : "N" 
            } 
        } 
    ],  
    "cat_prod_serv_archivos" : [ 
        { 
            "DesArchivo" : "Foto del producto",  
            "RutaArchivo" : "https://images.pexels.com/photos/3230214/pexels-photo-3230214.jpeg?auto=compress&cs=tinysrgb&h=750&w=1260",  
            "IdTipoGenArchivoOK" : "7",  
            "IdGenArchivoOK" : "19",  
            "TipoArchivo" : "IMAGEN",  
            "IdTipoGenSeccionOK" : "",  
            "IdGenSeccionOK" : "",  
            "TipoSeccion" : "",  
            "Secuencia" : 1,  
            "Principal" : "S",  
            "detail_row" : { 
                "FechaReg" : "2022-01-05T10:20:33+07:00",  
                "UsuarioReg" : "FIBARRAC",  
                "FechaUltMod" : "2022-01-05T10:20:33+07:00",  
                "UsuarioMod" : "FIBARRAC",  
                "Activo" : "S",  
                "Borrado" : "N" 
            } 
        } 
    ],  
    "cat_prod_serv_info_adicional" : [ 
        { 
            "IdEtiqueta" : "IDMODELO",  
            "Etiqueta" : "MODELO",  
            "Valor" : "G326 2 PTAS CO2",  
            "IdTipoGenSeccionOK" : "10",  
            "IdGenSeccionOK" : "33",  
            "TipoSeccion" : "SECCIÓN PRINCIPAL PRODUCTO SERVICIO",  
            "Secuencia" : 10,  
            "detail_row" : { 
                "FechaReg" : "2022-01-05T10:20:33+07:00",  
                "UsuarioReg" : "FIBARRAC",  
                "FechaUltMod" : "2022-01-05T10:20:33+07:00",  
                "UsuarioMod" : "FIBARRAC",  
                "Activo" : "S",  
                "Borrado" : "N" 
            } 
        },  
        { 
            "IdEtiqueta" : "IDMARCA",  
            "Etiqueta" : "MARCA",  
            "Valor" : "IMBERA",  
            "IdTipoGenSeccionOK" : "10",  
            "IdGenSeccionOK" : "33",  
            "TipoSeccion" : "SECCIÓN PRINCIPAL PRODUCTO SERVICIO",  
            "Secuencia" : 20,  
            "detail_row" : { 
                "FechaReg" : "2022-01-05T10:20:33+07:00",  
                "UsuarioReg" : "FIBARRAC",  
                "FechaUltMod" : "2022-01-05T10:20:33+07:00",  
                "UsuarioMod" : "FIBARRAC",  
                "Activo" : "S",  
                "Borrado" : "N" 
            } 
        },  
        { 
            "IdEtiqueta" : "IDDIMENCIONMM",  
            "Etiqueta" : "DIMENCIÓN EN MM",  
            "Valor" : "1985/1000/658",  
            "IdTipoGenSeccionOK" : "10",  
            "IdGenSeccionOK" : "33",  
            "TipoSeccion" : "SECCIÓN PRINCIPAL PRODUCTO SERVICIO",  
            "Secuencia" : 30,  
            "detail_row" : { 
                "FechaReg" : "2022-01-05T10:20:33+07:00",  
                "UsuarioReg" : "FIBARRAC",  
                "FechaUltMod" : "2022-01-05T10:20:33+07:00",  
                "UsuarioMod" : "FIBARRAC",  
                "Activo" : "S",  
                "Borrado" : "N" 
            } 
        },  
        { 
            "IdEtiqueta" : "IDPESOKG",  
            "Etiqueta" : "PESO EN KG",  
            "Valor" : "152.500",  
            "IdTipoGenSeccionOK" : "10",  
            "IdGenSeccionOK" : "33",  
            "TipoSeccion" : "SECCIÓN PRINCIPAL PRODUCTO SERVICIO",  
            "Secuencia" : 40,  
            "detail_row" : { 
                "FechaReg" : "2022-01-05T10:20:33+07:00",  
                "UsuarioReg" : "FIBARRAC",  
                "FechaUltMod" : "2022-01-05T10:20:33+07:00",  
                "UsuarioMod" : "FIBARRAC",  
                "Activo" : "S",  
                "Borrado" : "N" 
            } 
        } 
    ],  
    "detail_row" : { 
        "FechaReg" : "2022-01-05T10:20:33+07:00",  
        "UsuarioReg" : "FIBARRAC",  
        "FechaUltMod" : "2022-01-05T10:20:33+07:00",  
        "UsuarioMod" : "FIBARRAC",  
        "Activo" : "S",  
        "Borrado" : "N" 
    } 
}

# Nota: 
# Cada petición debe devolver un objeto JSON con los datos del producto/servicio solicitado.
# Si el producto/servicio no existe, la API debe responder con un error 404.
# Los ejemplos muestran la estructura esperada de los resultados
# 

#!nota 8.1 a 8.4---------------------------------------------------------------------------
###
# PUT (update documento completo/parcial) por IdProdServOK
# -> usa el controlador putProdServItem (keyType=OK por default)
PUT {{api}}/LAP001
Content-Type: application/json

{
  "DesProdServ": "ENFRIADOR VERTICAL G326 2PTAS CO2 (Actualizado)",
  "IdMedidaOK": "2",
  "detail_row": {
    "UsuarioMod": "sergio"
  }
}

###
# PUT (update documento) por IdProdServBK
PUT {{api}}/ENSA100?keyType=BK
Content-Type: application/json

{
  "DesProdServ": "Cambio por BK",
  "detail_row": {
    "UsuarioMod": "sergio"
  }
}

###
# PUT UPSERT ARRAY: cat_prod_serv_estatus
# -> ruta: /prod-serv/:id/array/:arrayName  (?keyType=OK|BK)
# Coincidencia por default: ['IdTipoGenEstatusOk','IdGenEstatusOk']
PUT {{api}}/PS1001/array/cat_prod_serv_estatus
Content-Type: application/json

{
  "items": [
    {
      "IdTipoGenEstatusOk": "EST",
      "IdGenEstatusOk": "VIG",
      "TipoEstatus": "VIGENTE",
      "Actual": "S",
      "Observacion": "Se mantiene vigente",
      "detail_row": {
        "UsuarioReg": "sergio"
      }
    },
    {
      "IdTipoGenEstatusOk": "EST",
      "IdGenEstatusOk": "SUSP",
      "TipoEstatus": "SUSPENDIDO",
      "Actual": "N",
      "Observacion": "Solo ejemplo",
      "detail_row": {
        "UsuarioReg": "sergio"
      }
    }
  ]
}

###
# PUT UPSERT ARRAY: cat_prod_serv_archivos
# Aquí forzamos match por RutaArchivo (para evitar duplicados por URL)
PUT {{api}}/PS1001/array/cat_prod_serv_archivos
Content-Type: application/json

{
  "matchKeys": ["RutaArchivo"],
  "items": [
    {
      "DesArchivo": "Foto principal",
      "RutaArchivo": "https://images.pexels.com/photos/3230214/pexels-photo-3230214.jpeg",
      "IdTipoGenArchivoOK": "IMG",
      "IdGenArchivoOK": "JPG",
      "TipoArchivo": "IMAGEN",
      "Secuencia": 1,
      "Principal": "S",
      "detail_row": {
        "UsuarioReg": "sergio"
      }
    }
  ]
}